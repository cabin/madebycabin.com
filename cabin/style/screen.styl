@import nib
@import default
@import util

cabin_black = #2b2b2b
cabin_grey_dark = #929292
cabin_grey_med = #d2d2d2
cabin_grey_light = #f2f2f2
cabin_mustard = #edbc13


// Common  ///////////////////////////////////////////////////////////////////

body
  color: cabin_black
  font: 13px/16px ProximaNova, Helvetica Neue, Helvetica, sans-serif

a
  text-decoration: none

.headline-text
  font: 30px/1.2 'YWFT Ultramagnetic Light'
  text-transform: uppercase

.dim-text
  color: cabin_grey_dark
  font-weight: normal

h1
  @extend .headline-text


hover-hr(duration = 200ms)
  position: relative
  hr
    absolute: top left
    background: cabin_black
    border: none
    margin: 0
    size: 0 1px
    transition: width duration
  .no-touch &:hover hr
    width: 100%


// Common nav/splash goodies  ////////////////////////////////////////////////

body > header
  absolute: top left
  right: 0
  display: none
  padding-top: 15%
  color: white
  light-text()

  h1, h2
    margin: 0 auto
    text-align: center
  h1
    font-size: 100px
  h2
    border-top: 1px solid rgba(white, .2)
    font: bold italic 25px/30px Georgia
    margin-top: 20px
    max-width: 80%
    padding-top: 20px
    width: 420px

nav
  fixed: top left
  right: 0
  z-index: 2
  > a
    font-weight: bold
    text-transform: uppercase
  .logo
    hide-text()

// Make sure the main content is tall enough to cover the splash during
// transitions, and set up its initial position so animation works.
html, body
  height: 100%
.main
  background: #fff
  box-sizing: border-box
  min-height: 100%
  relative: top

body.splash
  // Avoid page-width jump.
  overflow-y: scroll

  > header
    display: block
  nav
    absolute: bottom 0
    top: auto
  .main
    display: none

// Show everyone while transitioning.
body.splash-transition
  header, .main
    display: block

// XXX temporary animation
.loading nav .logo
  animation: rotate 750ms infinite ease-out
  transform-origin: center 60%
@keyframes rotate
  from
    transform: rotate(0deg)
  to
    transform: rotate(360deg)


// Work page common bits  ////////////////////////////////////////////////////

// XXX tmp
.content
  clearfix()
  margin: 0 30px

.bricks
  opacity: 0
  // masonry class is added after initial layout, so we can avoid initial
  // transitions.
  &.masonry
    opacity: 1
    transition-property: opacity, height, width
    &, .masonry-brick
      transition-duration: 300ms
      transform: translate3D(0, 0, 0)
    .masonry-brick
      transition-property: left, right, top

.work-thumb
  space_between = 80px
  hover-hr(300ms)
  border-top: 1px solid cabin_grey_light
  color cabin_black
  display: block
  float: left
  margin-bottom: (space_between / 2)
  margin-right: 20px
  padding-top: 14px
  padding-bottom: (space_between / 2)
  width: 260px

  h2, h3
    font-size 1em
    margin: 0
  h2
    text-transform: uppercase
  h3
    @extends .dim-text
    margin-bottom: 24px  // XXX revisit; should be 30
  img
    margin: 0 auto
    display: block
    max-width: 100%
    height: auto


// iPhone 5 landscape and smaller  ///////////////////////////////////////////

@media only screen and (max-width: 568px)
  nav_height = 40px

  // XXX tmp
  .content
    margin: 0 20px

  nav
    background: cabin_black
    display: table
    width: 100%
    height: nav_height
    line-height: @height

    .logo
      src = 'symbol-white.png'
      s = image-size(src)
      background-image: url(src)
      background-position: center center
      background-repeat: no-repeat
      background-size: s[0] s[1]
      border-left: none
      text-indent: -999px
    > a
      light-text()
      border-left: 1px solid black
      color: #fff
      display: table-cell
      text-align: center
      width: 25%
      hr
        display: none

  body > header
    bottom: nav_height
  .main
    padding-top: nav_height

  footer
    display: none

  extend-borders(page_padding = 20px)
    padding-left: page_padding
    padding-right: page_padding
    margin-left: -(page_padding)
    margin-right: -(page_padding)

  .single-column .work-thumb
    extend-borders()


// Larger than iPhone 5 landscape  ///////////////////////////////////////////

@media only screen and (min-width: 569px)
  nav_height = 90px
  footer_height = 60px

  nav
    background: #fff
    border-bottom: 1px solid cabin_grey_light
    height: (nav_height / 3)
    line-height: @height
    padding: @height
    text-align: right

    .logo
      src = 'symbol-black.png'
      s = image-size(src)
      background-image: url(src)
      background-size: s[0] s[1]
      float: left
      margin-left: 0
      size: s[0] s[1]
      padding: 0
      .no-touch &:hover
        background-image: url('symbol-hover.png')

    > a
      hover-hr()
      color: cabin_black
      display: inline-block
      margin-left: 10px
      padding: 0 10px
      position: relative

  body > header
    bottom: nav_height
  .main
    padding-top: nav_height

  .main
    padding-bottom: footer_height
  footer
    absolute: bottom left; right: 0
    background: cabin_grey_light
    box-shadow: inset 0 2px 2px -2px cabin_grey_dark
    height: footer_height
    line-height: @height
    overflow: hidden
    padding: 0 30px
    &, a
      color: cabin_grey_dark
    span
      color: cabin_grey_med
      display: inline-block
      margin: 0 5px
    ol
      inline-list()
    .copyright
      float: right
      margin: 0
      text-transform: uppercase

  .work-thumb
    &.feature
      width: 540px
    // Cover the top border with the hover-hr.
    hr
      top: -1px


// Neither CSS nor Stylus reliably supports nested media queries, so here we go
// with Retina images.  XXX it works if you use a & immediately inside the nest
// XXX having these here along with inlined images penalizes all devices
@media only screen and (max-width: 568px) and (-webkit-min-device-pixel-ratio: 1.5)
  nav .logo
    background-image: url('symbol-white@2x.png')

@media only screen and (min-width: 569px) and (-webkit-min-device-pixel-ratio: 1.5)
  nav .logo
    background-image: url('symbol-black@2x.png')
    .no-touch &:hover
      background-image: url('symbol-hover@2x.png')
